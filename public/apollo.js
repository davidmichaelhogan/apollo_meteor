"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Apollo=function(){function e(){var t=this;_classCallCheck(this,e),this.api="https://server.launchapollo.com",this.isVisible=!1,this.el=null,this.isDragging=!1,this.dragStartPosition=null,this.currentDragPosition=null,this.bodyMargin=0,this.rand=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},this.createElement(),this.request(this.api+"/ad?publisher="+window.ApolloOptions.publisher,function(e){e?t.showAd(JSON.parse(e)):t.request(t.api+"/remnant?publisher="+window.ApolloOptions.publisher,function(e){t.createRemnant(JSON.parse(e))})}),this.attachEvents()}return _createClass(e,[{key:"isTouchDevice",value:function(){return"ontouchstart"in window}},{key:"request",value:function(e,t){try{var i=new(window.XMLHttpRequest||window.ActiveXObject)("MSXML2.XMLHTTP.3.0");i.open("GET",e,1),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","application/json"),i.onreadystatechange=function(){i.readyState>3&&t&&t(i.responseText,i)},i.send()}catch(e){window.console&&console.log(e)}}},{key:"createElement",value:function(){this.el=document.createElement("div"),this.el.style.width="calc(100% - "+(this.bodyMargin+20)+"px)",this.el.style.padding="0 10px",this.el.style.position="fixed",this.el.style.top="-300px",this.el.style.zIndex="3000000",this.el.style.transition="top 500ms ease",this.el.style.boxSizing="content-box",document.body.insertAdjacentElement("beforeend",this.el)}},{key:"createRemnant",value:function(e){var t=this;console.log(e);var i=screen.width,n=i/2,o='<iframe id="apolloFrame" src="'+e.link+'" style="background-color: transparent" allow-transparency="true" frameBorder="0" scrolling="no" width="'+(i-20)+'" height="110"></iframe>';if(e.click)o='<iframe id="apolloFrame" src="'+e.link+'?click=yes" style="background-color: transparent" allow-transparency="true" frameBorder="0" scrolling="no" width="'+(i-20)+'" height="500"></iframe>',this.el.style.zIndex="-3000000",this.el.style.position="fixed",this.el.style.left=0,this.el.style.top="30px",this.isTouchDevice()||(document.onmousemove=function(e){t.el.style.left=e.pageX-n+"px",t.el.style.top=e.pageY-150+"px"}),setTimeout(function(){t.el.style.zIndex="3000000"},12e3),setTimeout(function(){t.el.style.zIndex="-3000000"},18e4);else if(e.show&&this.isTouchDevice()){var s=this;setTimeout(function(){s.el.style.top="10px",s.isVisible=!0},2e3),setTimeout(function(){s.el.style.top="-300px",s.isVisible=!1},1e4)}this.el.innerHTML=o}},{key:"onTouchStart",value:function(e){var t=e.touches[0].clientY;t<=250&&this.isVisible&&(this.el.style.transition="",this.isDragging=!0,this.dragStartPosition=t)}},{key:"onTouchMove",value:function(e){var t=e.touches[0].clientY,i=this.isDragging?-1*(this.dragStartPosition-t)+10:null;this.currentDragPosition=t,i&&(this.el.style.top=(i>10?10:i)+"px")}},{key:"onTouchEnd",value:function(e){var t=this.dragStartPosition-this.currentDragPosition;this.isVisible&&(this.el.style.transition="top 500ms ease",this.isDragging=!1,this.el.style.top=t>30?"-300px":"10px",this.isVisible=t<=30)}},{key:"attachEvents",value:function(){document.body.addEventListener("touchstart",this.onTouchStart.bind(this),!1),document.body.addEventListener("touchmove",this.onTouchMove.bind(this),!1),document.body.addEventListener("touchend",this.onTouchEnd.bind(this),!1)}},{key:"showAd",value:function(e){var t='<a href="'+this.api+"/click?publisher="+window.ApolloOptions.publisher+"&id="+e.id+'" target="_blank" style="display: block; width: 100%; text-decoration: none; font-family: arial, sans-serif; font-size: 20px;">\n      <div style="background-color:rgba(234, 237, 240, 1); color:rgb(224,227,230); border-top-right-radius: 10px; border-top-left-radius: 10px; padding: 5px 10px;">\n        <div style="width: 25px; float:left; display:inline-block;">\n          <img src="'+e.logo+'" style="max-width: 100%; max-height: 25px;">\n        </div>\n        <div style="float: right; width: calc(100% - 30px); color:#000; line-height: 25px;">'+e.headline+'</div>\n        <div style="clear:both;"></div>\n      </div>\n      <div style="color:#000; padding: 10px; background-color:rgba(224, 227, 230, .95); border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; font-size: 15px;">\n        '+e.subline+"\n      </div>\n    </a>";if(this.el.innerHTML=t,this.isTouchDevice()){var i=this;setTimeout(function(){i.el.style.top="10px",i.isVisible=!0},2e3),setTimeout(function(){i.el.style.top="-300px",i.isVisible=!1},1e4)}}}]),e}();"undefined"!=typeof window&&window.document&&window.document.createElement&&(window.Apollo=new Apollo);
